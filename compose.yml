services:
  # arya:
  #   build: ./dnsserver
  #   container_name: arya
  #   hostname: arya
  #   networks:
  #     dhcp_lab:
  #       ipv4_address: 192.168.10.11
  #   cap_add:
  #     - NET_ADMIN
  #   volumes:
  #     - ./dnsserver/bind/named.conf.options:/etc/bind/named.conf.options
  #     - ./arya/zonas/db.lannister.lan:/etc/bind/db.lannister.lan
  ned:
    build: ./kea
    container_name: ned
    hostname: ned
    networks:
      rede_stark:
        ipv4_address: 192.168.10.10
    cap_add:
      - NET_ADMIN
    volumes:
      - ./ned/dhcp4.json:/etc/kea/kea-dhcp4.conf
  router:
    build: ./router
    container_name: router
    hostname: router
    cap_add:
      - NET_ADMIN
    sysctls:
      - net.ipv4.ip_forward=1
    networks:
      rede_wan:
        ipv4_address: 192.0.2.254
        interface_name: eth0
      rede_stark:
        ipv4_address: 192.168.10.254
        interface_name: eth1
      rede_lannister:
        ipv4_address: 192.168.11.254
        interface_name: eth2
      rede_targaryen:  
        ipv4_address: 192.168.12.254
        interface_name: eth3
  # cliente1:
  #   build: ./cliente
  #   container_name: client1
  #   networks:
  #     dhcp_lab:
  #       ipv4_address: 192.168.10.3
  #       mac_address: 02:42:ac:11:00:10  # direcciÃ³n HW fija
  #   cap_add:
  #     - NET_ADMIN
  #   command: >
  #     sh -c "dhclient -v eth0 && sleep infinity"

networks:
  rede_stark:
    driver: bridge
    ipam:
      config:
        - subnet: 192.168.10.0/24
  rede_lannister:
    driver: bridge
    ipam:
      config:
        - subnet: 192.168.11.0/24
  rede_targaryen:
    driver: bridge
    ipam:
      config:
        - subnet: 192.168.12.0/24
  rede_wan:
    driver: bridge
    ipam:
      config:
        - subnet: 192.0.2.0/24 